-- Create tables --

CREATE TABLE Staff (
sid INT NOT NULL AUTO_INCREMENT,
sname VARCHAR(50) NOT NULL,
stype VARCHAR(30) NOT NULL,
sdate DATE NOT NULL,
periodicity INT NOT NULL,
dob DATE NOT NULL,
gender VARCHAR(20) NOT NULL,
phone VARCHAR(20),
pay FLOAT NOT NULL,
PRIMARY KEY (sid, sdate)
);


CREATE TABLE Publications (
pid INT AUTO_INCREMENT PRIMARY KEY,
title VARCHAR(250) NOT NULL,
ptype VARCHAR(30) NOT NULL,
dop DATE NOT NULL,
url VARCHAR(2048) NOT NULL,
price FLOAT
);

CREATE TABLE Books(
pid INT,
ISBN VARCHAR(50) NOT NULL,
edition INT,
FOREIGN KEY(pid) REFERENCES Publications(pid) ON UPDATE CASCADE
ON DELETE CASCADE
);

CREATE TABLE Chapters(
pid INT,
chno INT,
chtitle VARCHAR(150) NOT NULL,
url VARCHAR(2048) NOT NULL,
modifyDate DATE NOT NULL,
PRIMARY KEY(pid, chno),
FOREIGN KEY(pid) REFERENCES Publications(pid) ON UPDATE CASCADE
);

CREATE TABLE PeriodicPublication (
pid INT,
periodicity INT NOT NULL,
pptype VARCHAR(30) NOT NULL,
FOREIGN KEY(pid) REFERENCES Publications(pid)
ON UPDATE CASCADE

);

CREATE TABLE Issue(
pid INT,
ino INT,
PRIMARY KEY(pid, ino),
FOREIGN KEY(pid) REFERENCES Publications(pid) ON UPDATE CASCADE
ON DELETE CASCADE
);

CREATE TABLE Articles(
aid INT AUTO_INCREMENT PRIMARY KEY,
atitle VARCHAR(350) NOT NULL,
doc DATE NOT NULL,
url VARCHAR(2048) NOT NULL
);

CREATE TABLE Topics(
topic VARCHAR(50) PRIMARY KEY
);

CREATE TABLE Orders(
oid INT AUTO_INCREMENT PRIMARY KEY,
price FLOAT NOT NULL,
copies INT NOT NULL,
shcost FLOAT NOT NULL,
odate DATE NOT NULL
);

CREATE TABLE Distributors(
did INT AUTO_INCREMENT PRIMARY KEY,
dname VARCHAR(100) NOT NULL,
dtype VARCHAR(50) NOT NULL,
city VARCHAR(50) NOT NULL,
address VARCHAR(200) NOT NULL,
contact VARCHAR(50) NOT NULL,
phno VARCHAR(20) NOT NULL,
tot_balance FLOAT
);

CREATE TABLE ConsistOf(
oid INT,
pid INT,
FOREIGN KEY(oid) REFERENCES Orders(oid) ON UPDATE CASCADE,
FOREIGN KEY(pid) REFERENCES Publications(pid) ON UPDATE CASCADE
);

CREATE TABLE MakeOrder(
did INT,
oid INT,
FOREIGN KEY(did) REFERENCES Distributors(did) ON UPDATE CASCADE,
FOREIGN KEY(oid) REFERENCES Orders(oid) ON UPDATE CASCADE
);

CREATE TABLE ContainArticle(
pid INT,
aid INT,
FOREIGN KEY(pid) REFERENCES Publications(pid) ON UPDATE CASCADE,
FOREIGN KEY(aid) REFERENCES Articles(aid) ON UPDATE CASCADE
);

CREATE TABLE Edit(
pid INT,
sid INT,
sdate DATE,
FOREIGN KEY(pid) REFERENCES Publications(pid) ON UPDATE CASCADE,
FOREIGN KEY(sid, sdate) REFERENCES Staff(sid, sdate)
ON UPDATE CASCADE
);

CREATE TABLE HasTopic(
pid INT,
topic VARCHAR(50),
FOREIGN KEY(pid) REFERENCES Publications(pid) ON UPDATE CASCADE,
FOREIGN KEY(topic) REFERENCES Topics(topic) ON UPDATE CASCADE
);

CREATE TABLE WriteArticle(
aid INT,
sid INT,
sdate DATE,
FOREIGN KEY(aid) REFERENCES Articles(aid) ON UPDATE CASCADE,
FOREIGN KEY(sid, sdate) REFERENCES Staff(sid, sdate)
ON UPDATE CASCADE
);

CREATE TABLE WriteBook(
pid INT,
sid INT,
sdate DATE,
FOREIGN KEY(pid) REFERENCES Publications(pid) ON UPDATE CASCADE,
FOREIGN KEY(sid, sdate) REFERENCES Staff(sid, sdate)
ON UPDATE CASCADE
);